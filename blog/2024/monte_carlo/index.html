<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Monte Carlo | Abhinav Pratap Singh</title> <meta name="author" content="Abhinav Pratap Singh"> <meta name="description" content="Because basics are important"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%8C%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://ayushinav.github.io/blog/2024/monte_carlo/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Abhinav </span>Pratap Singh</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Monte Carlo</h1> <p class="post-meta">February 2, 2024</p> <p class="post-tags"> <a href="/blog/2024"> <i class="fas fa-calendar fa-sm"></i> 2024 </a>   ·   <a href="/blog/tag/probability"> <i class="fas fa-hashtag fa-sm"></i> probability</a>   <a href="/blog/tag/math"> <i class="fas fa-hashtag fa-sm"></i> math</a>   </p> </header> <article class="post-content"> <h1 id="why-monte-carlo">Why Monte Carlo</h1> <p>More generally, the method is used to perform numerical integration. There exist various other methods for the task., eg. Trapezoid rule, Simpson’s rule, Runge-Kutta method of various orders, Guass quadrature and many more. These methods provide a convergence rate of \(\mathcal{O}(n^{-2})\) or better for \(n\) nodes. If we know something about the function, we can reduce the number of points and still get the desired accuracy, eg. if a function is known to be quadratic, we can get the exact integral from 3 nodes.</p> <p>While these methods may appear good so far, they do not scale well with higher dimensions. Since, these methods rely upon discretizing the space, the number of points increases exponentially with the number of dimensions. In a \(d\)-dimensional space, if we have \(n\) points in each dimension, the total number of points becomes \(n^d\). Monte Carlo method of integrating function is essentially mesh-free. It is performed by sampling random points from a certain distribution and evaluating the function at those points. This draws motivation from the Gauss Quadrature to integrate functions.</p> <p><strong>Brief intro to Gauss quadrature:</strong> Gauss quadrature is an efficient way to estimate the integral of a function. It provides better accuracy because unlike Trapezoid rule, Simpson’s rules, the node points are also free. Intuitively, it would make more sense to put more points in the region where function peaks to get better estimate.</p> <p>The method particularly integrates functions of the form \(\int_a^b f(x) w(x) dx\) where \(w(x)\) has properties of a density function. When evaluating \(\int_a^b f(x) dx\), we simply substitute a \(f^*(x) = f(x)/w(x)\) and then estimate \(\int_a^b f^*(x) w(x) dx\).</p> <p>The properties of \(w(x)\) determine the orthogonal polynomials, whose roots become the node points and the weights are estimated by a recursion relationship, getting to the form</p> \[\int_a^b f(x) w(x) dx = \sum_i^n A_i f(x_i)\] <hr> <p>Something similar works in Monte Carlo integration. When integrating a function of the form \(\int_a^b f(x) w(x) dx\), we draw samples from the density function specified by \(w(x)\) and evaluate \(f(x)\) at these points, i.e.</p> \[\int_a^b f(x) w(x) dx = \sum_i f(x_i) \; , \; x \sim w(x)\] <p>The above has its foundations in the law of large numbers. When calculating mean of a distribution, we take the expectation:</p> \[\mu = \frac{1}{n}\sum_i^n x_i ; \; x_i \sim w(x) \xrightarrow[]{n \rightarrow \infty} \int_{\Omega} w(x) dx\] <p>and similarly, for the mean of the function on some distribution:</p> \[\mu(f(\cdot)) = \frac{1}{n}\sum_i^n f(x_i) ; \; x_i \sim w(x) \xrightarrow[]{n \rightarrow \infty} \int_{\Omega} f(x) w(x) dx\] <p>The above is also written as:</p> \[\begin{align*} \mathbf{E}_{x \sim w(x)}[f(x)] &amp; = \sum_i f(x_i) \; ; x_i \sim w(x) \\ &amp; = \int w(x) f(x) dx \end{align*}\] <p>Until now, we’d assumed that sampling from \(w(x)\) is easy. This might be true for certain families of distribution, but not always. The <a href="../../../2024/sampling/">Sampling</a> provides dives into how distributions are sampled.</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Abhinav Pratap Singh. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id="></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>